---
"description": "اكتشف كيفية تحسين مستندات Excel الخاصة بك عن طريق تخصيص الرؤوس والتذييلات برمجيًا باستخدام Aspose.Cells لـ .NET. يرشدك هذا الدليل الشامل خلال كل خطوة، بدءًا من إعداد مصنفك ووصولًا إلى إدراج اسم ورقة العمل ديناميكيًا."
"linktitle": "تنفيذ الرأس والتذييل باستخدام Aspose.Cells لـ .NET"
"second_title": "واجهة برمجة تطبيقات معالجة Excel لـ Aspose.Cells .NET"
"title": "تنفيذ الرأس والتذييل باستخدام Aspose.Cells لـ .NET"
"url": "/ar/cells/net/mastering-worksheet-page-setup-features/implement-header-footer/"
"weight": 22
---

## مقدمة

تُعد الرؤوس والتذييلات عناصر أساسية في جداول بيانات Excel، حيث توفر معلومات سياقية مهمة مثل أسماء الملفات والتواريخ وأرقام الصفحات. سواء كنت تُؤتمت التقارير أو تُنشئ ملفات ديناميكية، يُبسط Aspose.Cells for .NET عملية تخصيص الرؤوس والتذييلات برمجيًا. يقدم هذا الدليل نهجًا خطوة بخطوة لتحسين ملفات Excel الخاصة بك باستخدام رؤوس وتذييلات مُحسّنة واحترافية.

## المتطلبات الأساسية

قبل الغوص، تأكد من أن لديك ما يلي:

1. Aspose.Cells لـ .NET: قم بتنزيله وتثبيته من [هنا](https://releases.aspose.com/cells/net/).
2. إعداد IDE: استخدم Visual Studio أو IDE المفضل لديك مع إطار عمل .NET.
3. الترخيص: ابدأ بفترة تجريبية مجانية، ولكن فكّر في الحصول على ترخيص كامل أو مؤقت للاستفادة من جميع الوظائف. يمكنك [الحصول على رخصة مؤقتة](https://purchase.aspose.com/temporary-license/).

## استيراد الحزم المطلوبة

ابدأ باستيراد المساحات الأسماء الضرورية في مشروعك:

```csharp
using System.IO;
using Aspose.Cells;
using System;
```

سيمنحك هذا إمكانية الوصول إلى الفئات والطرق اللازمة للعمل مع الرؤوس والتذييلات والوظائف الأخرى في Excel في Aspose.Cells.

## الخطوة 1: إنشاء مصنف وإعداد صفحة الوصول

ابدأ بإنشاء مصنف جديد والوصول إلى إعدادات صفحة ورقة العمل. هنا يمكنك تعديل إعدادات الرأس والتذييل.

```csharp
// حدد المسار لحفظ مستندك
string dataDir = "Your Document Directory";

// إنشاء كائن مصنف
Workbook excel = new Workbook();
```

هنا، `Workbook` يمثل الكائن ملف Excel الخاص بك. `PageSetup` ستسمح لك خاصية ورقة العمل بتخصيص الرؤوس والتذييلات.

## الخطوة 2: الوصول إلى خصائص ورقة العمل وإعداد الصفحة

تحتوي كل ورقة عمل في Aspose.Cells على `PageSetup` الخاصية التي تحكم ميزات التخطيط، بما في ذلك الرؤوس والتذييلات. احصل على `PageSetup` كائن لورقة العمل الخاصة بك:

```csharp
// احصل على المرجع إلى PageSetup من ورقة العمل الأولى
PageSetup pageSetup = excel.Worksheets[0].PageSetup;
```

الآن، `pageSetup` يحتوي على الإعدادات المطلوبة لتخصيص الرؤوس والتذييلات.

## الخطوة 3: تعيين القسم الأيسر من الرأس

تتكون العناوين من ثلاثة أقسام: يسار، وسط، ويمين. لنبدأ بضبط القسم الأيسر لعرض اسم ورقة العمل.

```csharp
// تعيين اسم ورقة العمل في القسم الأيسر من الرأس
pageSetup.SetHeader(0, "&A");
```

استخدام `&A` يعرض اسم ورقة العمل بشكل ديناميكي، وهو أمر مفيد بشكل خاص لدفاتر العمل ذات الأوراق المتعددة.

## الخطوة 4: إضافة التاريخ والوقت إلى وسط الرأس

بعد ذلك، قم بإضافة التاريخ والوقت الحاليين إلى القسم الأوسط من الرأس، مع تطبيق خط مخصص للتصميم.

```csharp
// تعيين التاريخ والوقت في القسم الأوسط من الرأس باستخدام الخط العريض
pageSetup.SetHeader(1, "&\"Times New Roman,Bold\"&D-&T");
```

في هذا السطر:
- `&D` يقوم بإدراج التاريخ الحالي.
- `&T` يقوم بإدراج الوقت الحالي.
- `"Times New Roman,Bold"` يتم تطبيق الخط Times New Roman العريض.

## الخطوة 5: عرض اسم الملف في القسم الأيمن من الرأس

لإكمال العنوان، قم بعرض اسم الملف على الجانب الأيمن بحجم خط محدد.

```csharp
// عرض اسم الملف في القسم الأيمن من الرأس بحجم خط مخصص
pageSetup.SetHeader(2, "&\"Times New Roman,Bold\"&12&F");
```

هنا، `&F` يمثل اسم الملف، و `&12` تعيين حجم الخط إلى 12.

## الخطوة 6: إضافة نص مخصص إلى قسم التذييل الأيسر

الآن، دعنا نضبط قسم التذييل الأيسر بنص مخصص ونمط خط محدد.

```csharp
// أضف نصًا مخصصًا بنمط الخط إلى القسم الأيسر من التذييل
pageSetup.SetFooter(0, "Hello World! &\"Courier New\"&14 123");
```

في هذا المثال، النص `123` تم تصميمه باستخدام الخط "Courier New" بحجم 14، بينما يظل الباقي بالخط الافتراضي للتذييل.

## الخطوة 7: إدراج رقم الصفحة في منتصف التذييل

يساعد تضمين أرقام الصفحات في التذييل القراء على تتبع المستندات متعددة الصفحات.

```csharp
// أدخل رقم الصفحة في القسم الأوسط من التذييل
pageSetup.SetFooter(1, "&P");
```

ال `&P` يضيف الكود رقم الصفحة الحالية إلى قسم وسط التذييل.

## الخطوة 8: إظهار إجمالي عدد الصفحات في قسم التذييل الأيمن

أكمل التذييل عن طريق عرض إجمالي عدد الصفحات في القسم الأيمن.

```csharp
// عرض إجمالي عدد الصفحات في القسم الأيمن من التذييل
pageSetup.SetFooter(2, "&N");
```

ال `&N` يوفر الكود إجمالي عدد الصفحات، مما يخبر القراء بطول المستند.

## الخطوة 9: حفظ المصنف

أخيرًا، احفظ المصنف لتوليد ملف Excel بالرؤوس والتذييلات المخصصة.

```csharp
// حفظ المصنف
excel.Save(dataDir + "SetHeadersAndFooters_out.xls");
```

يحفظ هذا السطر الملف مع التخصيصات التي قمت بها في مكانها.

## خاتمة

يُحسّن تخصيص الرؤوس والتذييلات في جداول بيانات Excel من احترافية مستنداتك. باستخدام Aspose.Cells لـ .NET، يمكنك التحكم بسهولة في هذه العناصر، بدءًا من عرض أسماء جداول البيانات ووصولًا إلى إدراج نصوص مخصصة وتواريخ وأوقات وأرقام صفحات ديناميكية. الآن وقد تعلمت الخطوات، يمكنك الارتقاء بمشاريع أتمتة Excel الخاصة بك.

## الأسئلة الشائعة

### هل يمكنني استخدام خطوط مختلفة لأقسام مختلفة من الرؤوس والتذييلات؟
نعم، يسمح لك Aspose.Cells بتحديد خطوط فريدة لكل قسم من أقسام الرأس والتذييل.

### كيف يمكنني إزالة الرؤوس والتذييلات؟
قم بمسح الرؤوس والتذييلات عن طريق تعيين النص الخاص بها إلى سلسلة فارغة باستخدام `SetHeader` أو `SetFooter`.

### هل يمكنني إدراج الصور في الرؤوس أو التذييلات باستخدام Aspose.Cells لـ .NET؟
حاليًا، يدعم Aspose.Cells النصوص في الرؤوس والتذييلات بشكل أساسي. قد تتطلب الصور طرقًا بديلة، مثل إدراجها مباشرةً في ورقة العمل.

### هل يدعم Aspose.Cells البيانات الديناميكية في الرؤوس والتذييلات؟  
نعم، يمكنك استخدام أكواد ديناميكية مختلفة (مثل `&D` للتاريخ أو `&P` (لرقم الصفحة) لإضافة محتوى ديناميكي.

### كيف يمكنني تعديل ارتفاع الرأس أو التذييل؟  
يوفر Aspose.Cells خيارات داخل `PageSetup` فئة لضبط هوامش الرأس والتذييل، مما يتيح لك التحكم في التباعد.