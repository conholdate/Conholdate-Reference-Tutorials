---
"description": "تعرّف على كيفية تغيير الخطوط أثناء تحويل MHT باستخدام Aspose.Email لـ .NET. اتبع هذا الدليل خطوة بخطوة لتخصيص سهل."
"linktitle": "تغيير تخصيص خط MHT باستخدام C#"
"second_title": "واجهة برمجة تطبيقات معالجة البريد الإلكتروني Aspose.Email .NET"
"title": "تغيير تخصيص خط MHT باستخدام C#"
"url": "/ar/email/net/mastering-email-header-manipulation/changing-mht-font-customization/"
"weight": 11
---

## مقدمة

في عالم التواصل عبر الإنترنت، تُعد ملفات MHT (MHTML) وسيلةً سهلةً لتخزين ومشاركة محتوى الويب، بما في ذلك الصور والروابط والأنماط. ولكن ماذا لو احتجتَ إلى تحسين هذه الملفات بتغيير الخطوط؟ بفضل Aspose.Email لـ .NET، أصبحت هذه المهمة في غاية السهولة. في هذا البرنامج التعليمي، سنشرح لك خطوة بخطوة عملية تغيير الخطوط أثناء تحويل MHT. سواءً كنت تُطوّر تطبيقًا يُعنى بتنسيق البريد الإلكتروني أو ترغب فقط في تخصيص مستنداتك لشركتك، سيُزوّدك هذا الدليل بالمعرفة اللازمة.

## المتطلبات الأساسية

قبل الغوص في الكود، هناك بعض الأساسيات التي يجب عليك إعدادها:

1. Visual Studio: ستحتاج إلى بيئة تطوير متكاملة (IDE) للعمل على مشروع C# الخاص بك.
2. مكتبة Aspose.Email لـ .NET: تأكد من تثبيت المكتبة. يمكنك تنزيلها من [وصلة](https://releases.aspose.com/email/net/).
3. .NET Framework: يجب أن يكون مشروعك متوافقًا مع .NET Framework؛ عادةً، يعمل .NET Core أو الإصدارات الأحدث بشكل جيد.

هل رتبت هذه؟ رائع! لنبدأ.

## استيراد الحزم

أولاً، تأكد من إعداد مشروعك لاستخدام مساحات الأسماء اللازمة. ستحتاج إلى تضمين ما يلي في أعلى ملف C#:

```csharp
using Aspose.Email;
using Aspose.Email.Mime;
using Aspose.Email.Tools;
```

ستتيح لك هذه الحزم الوصول إلى الوظائف اللازمة للعمل مع ملفات MHT وتعديل محتوياتها.

الآن، دعونا نقوم بتفصيل الخطوات المتبعة في تغيير الخطوط أثناء تحويل MHT.

## الخطوة 1: تحميل ملف MHT

أول شيء عليك فعله هو تحميل ملف MHT الخاص بك إلى `MailMessage` هذا هو المكان الذي يمكنك من خلاله الوصول إلى محتواه والتحكم فيه.

```csharp
MailMessage message = MailMessage.Load("input.mht", new MhtmlLoadOptions());
```

التوضيح: هنا، `"input.mht"` هو المسار إلى ملف MHT الخاص بك. `MhtmlLoadOptions()` يسمح لك بتكوين كيفية تحميل الملف، على سبيل المثال، التعامل مع المرفقات أو الموارد المرتبطة بشكل مختلف.

## الخطوة 2: التكرار من خلال وجهات نظر بديلة

غالبًا ما تحتوي ملفات MHT على عدة عروض بديلة، خاصةً إذا كانت تتضمن محتوى HTML. ستحتاج إلى تكرار هذه العروض للعثور على العرض الذي تريد تعديله.

```csharp
foreach (var alternateView in message.AlternateViews)
{
    if (alternateView.ContentType.MediaType == "text/html")
    {
        var htmlView = (AlternateView)alternateView;
        var linkedResources = htmlView.LinkedResources;
```

الشرح: أنت تقوم بالتحقق من كل `AlternateView` لمعرفة ما إذا كان من نوع HTML. إذا كان كذلك، يمكنك الوصول إليه `LinkedResources`، حيث يتم عادةً تخزين أي خطوط مرتبطة بـ HTML.

## الخطوة 3: تحديد الخطوط وتخصيصها

الآن بعد أن أصبح لديك إمكانية الوصول إلى الموارد المرتبطة، يمكنك تحديد الموارد التي تمثل خطوطًا وتخصيصها حسب الحاجة.

```csharp
foreach (var linkedResource in linkedResources)
{
    if (linkedResource.ContentType.MediaType == "application/x-font-ttf")
    {
        linkedResource.ContentType.Name = "Arial";  // تغيير إلى الخط المطلوب
        linkedResource.TransferEncoding = TransferEncoding.Base64;  // تأكد من ترميزه بشكل صحيح
    }
}
```

شرح: تتحقق هذه الحلقة من أن نوع محتوى المورد المرتبط هو خط TrueType. إذا تطابق، يمكنك تغيير اسم الخط إلى الاسم الذي تريده (مثل "Arial" في هذا المثال). `TransferEncoding` يجب أيضًا ضبط ذلك للتأكد من ترميز بيانات الخط بشكل صحيح عند حفظ المستند.

## الخطوة 4: حفظ ملف MHT المحدث

بعد تخصيص الخطوط، حان وقت حفظ ملف MHT المُعدَّل. تأكد من استخدام خيارات الحفظ الصحيحة للحفاظ على سلامة ملفك.

```csharp
message.Save("output.mht", SaveOptions.DefaultMhtml);
```

الشرح: في هذا السطر من التعليمات البرمجية، `"output.mht"` هو اسم الملف الذي تريد حفظ المحتوى المُحدّث فيه. باستخدام `SaveOptions.DefaultMhtml` ويضمن أن الملف الجديد يحافظ على تنسيق MHT.

## خاتمة

يُمكن لتغيير الخطوط في ملفات MHT تحسين مظهر مستنداتك بشكل ملحوظ. باستخدام Aspose.Email لـ .NET، يُمكنك بسهولة تحميل ملفات MHT وتعديل محتواها وحفظ التغييرات باستخدام بضعة أسطر برمجية فقط. سواء كنت تعمل على مشروع شخصي أو تطبيق أكبر، فإن إتقان هذه المهارات يُحسّن طريقة عرضك للمعلومات.

## الأسئلة الشائعة

### ما هو تنسيق MHT؟
MHT هو تنسيق أرشيف لصفحات الويب يخزن مستندات HTML والصور والموارد الأخرى في ملف واحد.

### هل يمكنني تغيير جوانب أخرى من ملفات MHT باستخدام Aspose؟
بالتأكيد! يتيح لك Aspose.Email تعديل جميع جوانب ملفات MHT تقريبًا، بما في ذلك المرفقات والرؤوس وغيرها.

### هل Aspose.Email لـ .NET مجاني؟
يقدم Aspose نسخة تجريبية مجانية، لكن النسخة الكاملة تتطلب ترخيصًا. يمكنك الحصول على ترخيص مؤقت من [هنا](https://purchase.aspose.com/temporary-license/).

### أين يمكنني العثور على مزيد من الوثائق حول Aspose.Email؟
يمكنك العثور على وثائق وأمثلة شاملة في [صفحة توثيق البريد الإلكتروني Aspose](https://reference.aspose.com/email/net/).

### ماذا لو واجهت مشاكل أثناء استخدام Aspose؟
إذا واجهت أي مشاكل، يمكنك التواصل للحصول على الدعم على [منتدى دعم Aspose](https://forum.aspose.com/c/email/12/).