---
"description": "เรนเดอร์กิจกรรมในปฏิทินเป็นรูปแบบ MHTML โดยใช้ Aspose.Email สำหรับ .NET เรียนรู้วิธีปรับแต่งและบันทึกไฟล์ MSG ด้วย C# ทีละขั้นตอน"
"linktitle": "เรนเดอร์เหตุการณ์ปฏิทินใน MHTML โดยใช้ Aspose.Email"
"second_title": "API การประมวลผลอีเมล Aspose.Email .NET"
"title": "เรนเดอร์เหตุการณ์ปฏิทินใน MHTML โดยใช้ Aspose.Email"
"url": "/th/email/net/handling-email-events-and-calendar/render-calendar-events-in-mhtml/"
"weight": 15
---

## การแนะนำ

Aspose.Email สำหรับ .NET เป็นไลบรารีที่ทรงพลังสำหรับการจัดการงานที่เกี่ยวข้องกับอีเมลในแอปพลิเคชัน .NET กรณีการใช้งานที่น่าสนใจอย่างหนึ่งคือการเรนเดอร์กิจกรรมในปฏิทินด้วยโปรแกรม C# ไม่ว่าคุณจะกำลังสร้างฟีเจอร์การรวมปฏิทินหรือสร้างโปรแกรมดูอีเมลแบบกำหนดเอง บทช่วยสอนนี้จะแนะนำคุณตลอดการเรนเดอร์กิจกรรมในปฏิทินเป็นรูปแบบ MHTML ได้อย่างแม่นยำและปรับแต่งได้

## ข้อกำหนดเบื้องต้น

ก่อนที่เราจะเริ่มต้น เรามาแน่ใจก่อนว่าเราเตรียมทุกอย่างพร้อมแล้วสำหรับการปฏิบัติตามบทช่วยสอนนี้:

1. Aspose.Email สำหรับไลบรารี .NET: ดาวน์โหลดไลบรารีเวอร์ชันล่าสุดจาก [หน้าดาวน์โหลด Aspose.Email สำหรับ .NET](https://releases-aspose.com/email/net/).
2. สภาพแวดล้อมการพัฒนา: ติดตั้ง Visual Studio (หรือ IDE C# ที่คุณต้องการ) บนระบบของคุณ
3. ใบอนุญาต: รับใบอนุญาตที่ถูกต้องสำหรับ Aspose.Email เพื่อวัตถุประสงค์ในการประเมิน คุณสามารถใช้ [ใบอนุญาตชั่วคราว](https://purchase-aspose.com/temporary-license/).
4. ไฟล์ MSG ตัวอย่าง: ไฟล์ MSG กิจกรรมในปฏิทิน คุณสามารถใช้ไฟล์ใดก็ได้ `.msg` ไฟล์ที่มีเหตุการณ์ในปฏิทิน เช่น "การประชุมที่มีเหตุการณ์ที่เกิดขึ้นซ้ำ.msg"

## แพ็คเกจนำเข้า

ในการเริ่มต้น ให้รวมเนมสเปซที่จำเป็นไว้ในโครงการของคุณ 

```csharp
using System;
using Aspose.Email;
using Aspose.Email.Mht;
```

ตอนนี้เรามาดูคำแนะนำทีละขั้นตอนกันเลยดีกว่า!

## ขั้นตอนที่ 1: โหลดไฟล์ MSG เหตุการณ์ปฏิทิน

ขั้นแรก เราจะโหลดไฟล์ MSG ที่มีเหตุการณ์ในปฏิทิน ขั้นตอนนี้สำคัญมาก เพราะเป็นอินพุตสำหรับการแสดงผลเหตุการณ์ในรูปแบบ MHTML


```csharp
string dataDir = "Your Data Directory";
string fileName = "Meeting with Recurring Occurrences.msg";

// โหลดไฟล์ MSG
MailMessage msg = MailMessage.Load(dataDir + fileName);
```

- `dataDir`: ระบุไดเรกทอรีที่จัดเก็บไฟล์ MSG ของคุณ
- `fileName`: ชื่อไฟล์กิจกรรมปฏิทิน
- `MailMessage.Load`: อ่านไฟล์และโหลดลงใน `MailMessage` วัตถุ.

## ขั้นตอนที่ 2: กำหนดค่าตัวเลือกการบันทึก MHTML

ต่อไป เราจะกำหนดค่าตัวเลือกสำหรับการแสดงผลกิจกรรมในปฏิทินเป็นรูปแบบ MHTML ซึ่งรวมถึงการเปิดใช้งานรูปแบบ ส่วนหัว และคุณสมบัติอื่นๆ ที่เฉพาะเจาะจงสำหรับการปรับแต่ง

```csharp
MhtSaveOptions options = new MhtSaveOptions
{
    MhtFormatOptions = MhtFormatOptions.WriteHeader | MhtFormatOptions.RenderCalendarEvent
};
```

- `MhtSaveOptions`: แสดงถึงการตั้งค่าสำหรับการบันทึกไฟล์ MHTML
- `MhtFormatOptions`: กำหนดค่าตัวเลือกต่างๆ เช่น การรวมส่วนหัวและการเรนเดอร์เหตุการณ์ปฏิทิน

## ขั้นตอนที่ 3: ปรับแต่งเทมเพลตการแสดงผล

ที่นี่ เราจะกำหนดว่าคุณสมบัติเฉพาะ เช่น เวลาเริ่มต้นของเหตุการณ์ ควรปรากฏในผลลัพธ์อย่างไร ขั้นตอนนี้จะช่วยให้ผลลัพธ์สามารถปรับแต่งและอ่านได้สูง


```csharp
if (options.FormatTemplates.ContainsKey(MhtTemplateName.Start))
    options.FormatTemplates[MhtTemplateName.Start] = @"<span class='headerLineTitle'>Start:</span><span class='headerLineText'>{0}</span><br/>";
else
    options.FormatTemplates.Add(MhtTemplateName.Start, @"<span class='headerLineTitle'>Start:</span><span class='headerLineText'>{0}</span><br/>");
```

- `MhtTemplateName.Start`: หมายถึงคุณสมบัติ "เริ่ม" ของเหตุการณ์ปฏิทิน
- `options.FormatTemplates`:ปรับแต่งเทมเพลตการแสดงผลสำหรับคุณสมบัติเฉพาะ

## ขั้นตอนที่ 4: บันทึกเหตุการณ์ปฏิทินเป็น MHTML

สุดท้าย ให้บันทึกเหตุการณ์ปฏิทินลงในไฟล์ MHTML พร้อมตัวเลือกที่กำหนดค่าไว้


```csharp
msg.Save(dataDir + "Meeting with Recurring Occurrences.mhtml", options);
```

- `msg.Save`: บันทึกข้อความตามรูปแบบและตำแหน่งที่ระบุ
- `Meeting with Recurring Occurrences.mhtml`: ชื่อไฟล์เอาท์พุต

## บทสรุป

การเรนเดอร์กิจกรรมในปฏิทินโดยใช้ Aspose.Email สำหรับ .NET นั้นทั้งมีประสิทธิภาพและปรับแต่งได้สูง เพียงทำตามขั้นตอนข้างต้น คุณก็จะสามารถแปลงกิจกรรมในปฏิทินเป็นไฟล์ MHTML ได้อย่างราบรื่น พร้อมการจัดรูปแบบที่ปรับแต่งได้

## คำถามที่พบบ่อย

### MHTML คืออะไร?
MHTML เป็นรูปแบบไฟล์เก็บถาวรเว็บที่ประกอบด้วย HTML และทรัพยากรที่เกี่ยวข้อง เช่น รูปภาพ ทำให้เหมาะสำหรับการเรนเดอร์และการแชร์กิจกรรมในปฏิทิน

### ฉันสามารถแสดงกิจกรรมที่เกิดขึ้นซ้ำๆ ได้หรือไม่
ใช่! Aspose.Email รองรับการเรนเดอร์เหตุการณ์ที่เกิดขึ้นซ้ำๆ เพื่อให้แน่ใจว่ารายละเอียดทั้งหมดจะถูกบันทึกไว้อย่างถูกต้อง

### จำเป็นต้องมีใบอนุญาตหรือไม่?
ใช่ จำเป็นต้องมีใบอนุญาตที่ถูกต้อง คุณสามารถขอได้ [ใบอนุญาตชั่วคราว](https://purchase.aspose.com/temporary-license/) เพื่อการประเมินผล

### ฉันสามารถเพิ่มคุณสมบัติที่กำหนดเองลงในเอาต์พุตได้หรือไม่
แน่นอน! คุณสามารถปรับแต่งเทมเพลตสำหรับคุณสมบัติเพิ่มเติมได้โดยใช้ `FormatTemplates` ของสะสม.

### ฉันจะแก้ไขปัญหาได้อย่างไร?
เยี่ยมชม [ฟอรัมสนับสนุน Aspose.Email](https://forum.aspose.com/c/email/12/) เพื่อขอความช่วยเหลือจากผู้เชี่ยวชาญ