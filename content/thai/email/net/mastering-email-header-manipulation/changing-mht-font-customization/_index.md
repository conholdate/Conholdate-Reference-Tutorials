---
"description": "เรียนรู้วิธีเปลี่ยนฟอนต์ระหว่างการแปลง MHT โดยใช้ Aspose.Email สำหรับ .NET ทำตามคำแนะนำทีละขั้นตอนนี้เพื่อการปรับแต่งที่ง่ายดาย"
"linktitle": "การเปลี่ยนแปลงการปรับแต่งฟอนต์ MHT โดยใช้ C#"
"second_title": "API การประมวลผลอีเมล Aspose.Email .NET"
"title": "การเปลี่ยนแปลงการปรับแต่งฟอนต์ MHT โดยใช้ C#"
"url": "/th/email/net/mastering-email-header-manipulation/changing-mht-font-customization/"
"weight": 11
---

## การแนะนำ

ในโลกของการสื่อสารผ่านเว็บ ไฟล์ MHT (MHTML) เป็นวิธีที่สะดวกในการจัดเก็บและแบ่งปันเนื้อหาเว็บ ครบครันด้วยรูปภาพ ลิงก์ และสไตล์ แต่จะเกิดอะไรขึ้นเมื่อคุณต้องการปรับแต่งไฟล์ MHT เหล่านั้นด้วยการเปลี่ยนฟอนต์? ด้วย Aspose.Email สำหรับ .NET งานนี้จะกลายเป็นเรื่องง่ายดาย ในบทช่วยสอนนี้ เราจะแนะนำคุณเกี่ยวกับขั้นตอนการเปลี่ยนฟอนต์ระหว่างการแปลงไฟล์ MHT ทีละขั้นตอน ไม่ว่าคุณจะกำลังพัฒนาแอปพลิเคชันที่จัดการการจัดรูปแบบอีเมล หรือเพียงแค่ต้องการปรับแต่งเอกสารสำหรับธุรกิจของคุณ คู่มือนี้จะช่วยให้คุณมีความรู้ที่จำเป็น

## ข้อกำหนดเบื้องต้น

ก่อนที่จะเจาะลึกโค้ด มีสิ่งสำคัญบางประการที่คุณควรเตรียมไว้:

1. Visual Studio: คุณจะต้องมีสภาพแวดล้อมการพัฒนาแบบบูรณาการ (IDE) เพื่อทำงานบนโปรเจ็กต์ C# ของคุณ
2. Aspose.Email สำหรับไลบรารี .NET: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้งไลบรารีแล้ว คุณสามารถดาวน์โหลดได้จาก [ลิงค์](https://releases-aspose.com/email/net/).
3. .NET Framework: โปรเจ็กต์ของคุณควรเข้ากันได้กับ .NET Framework โดยทั่วไปแล้ว .NET Core หรือเวอร์ชันใหม่กว่าจะทำงานได้ดี

เตรียมพร้อมแล้วเหรอ? เยี่ยมเลย! เริ่มกันเลย

## การนำเข้าแพ็คเกจ

ก่อนอื่น ตรวจสอบให้แน่ใจว่าโปรเจ็กต์ของคุณได้รับการตั้งค่าให้ใช้เนมสเปซที่จำเป็นแล้ว คุณจะต้องใส่ข้อมูลต่อไปนี้ไว้ที่ด้านบนของไฟล์ C#:

```csharp
using Aspose.Email;
using Aspose.Email.Mime;
using Aspose.Email.Tools;
```

แพ็คเกจเหล่านี้จะช่วยให้คุณสามารถเข้าถึงฟังก์ชันการทำงานที่จำเป็นในการทำงานกับไฟล์ MHT และแก้ไขเนื้อหาของไฟล์เหล่านั้น

ตอนนี้เรามาดูขั้นตอนต่างๆ ที่เกี่ยวข้องกับการเปลี่ยนแบบอักษรระหว่างการแปลง MHT กัน

## ขั้นตอนที่ 1: โหลดไฟล์ MHT

สิ่งแรกที่คุณต้องทำคือโหลดไฟล์ MHT ของคุณลงใน `MailMessage` วัตถุ นี่คือที่ที่คุณสามารถเข้าถึงและจัดการเนื้อหาได้

```csharp
MailMessage message = MailMessage.Load("input.mht", new MhtmlLoadOptions());
```

คำอธิบาย: ที่นี่ `"input.mht"` เป็นเส้นทางไปยังไฟล์ MHT ของคุณ `MhtmlLoadOptions()` ช่วยให้คุณกำหนดค่าวิธีการโหลดไฟล์ได้ เช่น การจัดการสิ่งที่แนบมาหรือทรัพยากรที่เชื่อมโยงแตกต่างกัน

## ขั้นตอนที่ 2: ทำซ้ำผ่านมุมมองทางเลือก

ไฟล์ MHT มักจะมีมุมมองทางเลือกหลายแบบ โดยเฉพาะอย่างยิ่งหากมีเนื้อหา HTML อยู่ด้วย คุณต้องวนซ้ำมุมมองเหล่านี้เพื่อค้นหามุมมองที่คุณต้องการแก้ไข

```csharp
foreach (var alternateView in message.AlternateViews)
{
    if (alternateView.ContentType.MediaType == "text/html")
    {
        var htmlView = (AlternateView)alternateView;
        var linkedResources = htmlView.LinkedResources;
```

คำอธิบาย: คุณกำลังตรวจสอบแต่ละ `AlternateView` เพื่อดูว่าเป็นประเภท HTML หรือไม่ หากใช่ คุณสามารถเข้าถึง `LinkedResources`โดยที่แบบอักษรใดๆ ที่เชื่อมโยงกับ HTML จะถูกจัดเก็บโดยทั่วไป

## ขั้นตอนที่ 3: ระบุและปรับแต่งแบบอักษร

เมื่อคุณเข้าถึงทรัพยากรที่เชื่อมโยงแล้ว คุณสามารถระบุได้ว่าทรัพยากรใดเป็นแบบอักษรและปรับแต่งตามต้องการได้

```csharp
foreach (var linkedResource in linkedResources)
{
    if (linkedResource.ContentType.MediaType == "application/x-font-ttf")
    {
        linkedResource.ContentType.Name = "Arial";  // เปลี่ยนเป็นแบบอักษรที่ต้องการ
        linkedResource.TransferEncoding = TransferEncoding.Base64;  // ตรวจสอบให้แน่ใจว่ามีการเข้ารหัสอย่างถูกต้อง
    }
}
```

คำอธิบาย: ลูปนี้จะตรวจสอบว่าชนิดเนื้อหาของทรัพยากรที่ลิงก์เป็นฟอนต์ TrueType หรือไม่ หากตรงกัน คุณสามารถเปลี่ยนชื่อฟอนต์เป็นชื่อที่ต้องการได้ (เช่น "Arial" ในตัวอย่างนี้) `TransferEncoding` ควรตั้งค่าเพื่อให้แน่ใจว่าข้อมูลแบบอักษรได้รับการเข้ารหัสอย่างถูกต้องเมื่อบันทึกเอกสาร

## ขั้นตอนที่ 4: บันทึกไฟล์ MHT ที่อัปเดต

หลังจากปรับแต่งฟอนต์แล้ว ก็ถึงเวลาบันทึกไฟล์ MHT ที่แก้ไขแล้ว คุณต้องแน่ใจว่าได้ใช้ตัวเลือกการบันทึกที่ถูกต้องเพื่อรักษาความสมบูรณ์ของไฟล์

```csharp
message.Save("output.mht", SaveOptions.DefaultMhtml);
```

คำอธิบาย: ในบรรทัดโค้ดนี้ `"output.mht"` คือชื่อของไฟล์ที่คุณต้องการบันทึกเนื้อหาที่อัปเดต โดยใช้ `SaveOptions.DefaultMhtml` ช่วยให้แน่ใจว่าไฟล์ใหม่ยังคงรูปแบบ MHT

## บทสรุป

การเปลี่ยนฟอนต์ในไฟล์ MHT จะช่วยปรับปรุงรูปลักษณ์และความรู้สึกของเอกสารของคุณได้อย่างมาก ด้วยการใช้ Aspose.Email สำหรับ .NET คุณสามารถโหลดไฟล์ MHT แก้ไขเนื้อหา และบันทึกการเปลี่ยนแปลงได้อย่างง่ายดายด้วยโค้ดเพียงไม่กี่บรรทัด ไม่ว่าคุณจะทำงานในโครงการส่วนตัวหรือแอปพลิเคชันขนาดใหญ่ การฝึกฝนทักษะเหล่านี้จะช่วยพัฒนาวิธีการนำเสนอข้อมูลของคุณ

## คำถามที่พบบ่อย

### รูปแบบ MHT คืออะไร?
MHT เป็นรูปแบบไฟล์เก็บถาวรหน้าเว็บที่จัดเก็บเอกสาร HTML รูปภาพ และทรัพยากรอื่นๆ ไว้ในไฟล์เดียว

### ฉันสามารถเปลี่ยนแปลงส่วนอื่นๆ ของไฟล์ MHT โดยใช้ Aspose ได้หรือไม่
แน่นอน! Aspose.Email ช่วยให้คุณแก้ไขแทบทุกส่วนของไฟล์ MHT รวมถึงไฟล์แนบ ส่วนหัว และอื่นๆ อีกมากมาย

### Aspose.Email สำหรับ .NET ฟรีหรือไม่?
Aspose เสนอการทดลองใช้ฟรี แต่เวอร์ชันเต็มจำเป็นต้องมีใบอนุญาต คุณสามารถขอรับใบอนุญาตชั่วคราวได้จาก [ที่นี่](https://purchase-aspose.com/temporary-license/).

### ฉันสามารถหาเอกสารเพิ่มเติมเกี่ยวกับ Aspose.Email ได้ที่ไหน
คุณสามารถค้นหาเอกสารและตัวอย่างที่ครอบคลุมได้ที่ [หน้าเอกสารอีเมล Aspose](https://reference-aspose.com/email/net/).

### จะเกิดอะไรขึ้นหากฉันพบปัญหาขณะใช้ Aspose?
หากคุณประสบปัญหาใดๆ คุณสามารถติดต่อขอความช่วยเหลือได้ที่ [ฟอรั่มสนับสนุน Aspose](https://forum-aspose.com/c/email/12/).