---
"description": "ค้นพบวิธีจัดการไฟล์ Excel ขนาดใหญ่อย่างมีประสิทธิภาพด้วยการปรับระดับการบีบอัดโดยใช้ Aspose.Cells สำหรับ .NET คู่มือทีละขั้นตอนนี้ครอบคลุมทุกอย่างตั้งแต่การตั้งค่าไดเรกทอรีไปจนถึงการวัดระยะเวลาในการบีบอัด ช่วยให้คุณปรับขนาดไฟล์ให้เหมาะสมและเพิ่มประสิทธิภาพการทำงาน"
"linktitle": "การปรับระดับการบีบอัดในเวิร์กบุ๊ก"
"second_title": "API การประมวลผล Excel ของ Aspose.Cells .NET"
"title": "การปรับระดับการบีบอัดในเวิร์กบุ๊ก"
"url": "/th/cells/net/mastering-workbook-operations/adjusting-compression-level/"
"weight": 14
---

## การแนะนำ

การจัดการไฟล์ Excel ขนาดใหญ่อาจเป็นเรื่องท้าทาย โดยเฉพาะอย่างยิ่งเมื่อต้องจัดเก็บและถ่ายโอนข้อมูลอย่างมีประสิทธิภาพ โชคดีที่การบีบอัดไฟล์สามารถลดขนาดไฟล์เหล่านี้ได้อย่างมาก ทำให้จัดการได้ง่ายขึ้น หากคุณใช้ Aspose.Cells สำหรับ .NET คุณสามารถปรับระดับการบีบอัดของเวิร์กบุ๊กได้อย่างง่ายดาย คู่มือนี้จะแนะนำขั้นตอนต่างๆ ให้คุณทีละขั้นตอน พร้อมคำอธิบายที่ชัดเจนเกี่ยวกับแต่ละส่วนของโค้ด

## ข้อกำหนดเบื้องต้น

ก่อนที่เราจะเจาะลึกโค้ด โปรดตรวจสอบให้แน่ใจว่าคุณมีข้อกำหนดเบื้องต้นดังต่อไปนี้:

1. ความรู้พื้นฐานเกี่ยวกับ C#: ความคุ้นเคยกับการเขียนโปรแกรม C# จะช่วยให้คุณเข้าใจชิ้นส่วนโค้ดได้ดีขึ้น
2. ไลบรารี Aspose.Cells: ดาวน์โหลดและติดตั้งไลบรารี Aspose.Cells จาก [ที่นี่](https://releases-aspose.com/cells/net/).
3. Visual Studio: จำเป็นต้องมีสภาพแวดล้อมการพัฒนาเช่น Visual Studio สำหรับการรันโค้ด
4. .NET Framework: ตรวจสอบให้แน่ใจว่าโครงการของคุณได้รับการตั้งค่าด้วย .NET Framework เวอร์ชันที่เข้ากันได้

## การนำเข้าแพ็คเกจที่จำเป็น

ในการเริ่มต้น คุณต้องนำเข้าแพ็กเกจที่จำเป็นลงในโปรเจ็กต์ C# ของคุณ โดยเพิ่มบรรทัดต่อไปนี้ที่ด้านบนของไฟล์โค้ด:

```csharp
using Aspose.Cells.Rendering;
using Aspose.Cells.WebExtensions;
using System;
```

แพ็คเกจเหล่านี้มีความจำเป็นสำหรับการทำงานกับไฟล์ Excel โดยใช้ไลบรารี Aspose.Cells `Aspose.Cells` เนมสเปซประกอบด้วยคลาสทั้งหมดที่จำเป็นในการจัดการไฟล์ Excel ในขณะที่ `Aspose.Cells.Xlsb` ให้ตัวเลือกสำหรับการบันทึกไฟล์ในรูปแบบ XLSB

## ขั้นตอนที่ 1: กำหนดไดเรกทอรีแหล่งที่มาและเอาต์พุต

ขั้นแรก ให้ตั้งค่าไดเร็กทอรีที่ไฟล์ต้นฉบับของคุณตั้งอยู่และตำแหน่งที่คุณต้องการบันทึกไฟล์เอาต์พุต:

```csharp
// กำหนดไดเรกทอรีแหล่งที่มาและเอาต์พุต
string sourceDir = "Your Document Directory\\";
string outDir = "Your Document Directory\\";
```

อย่าลืมเปลี่ยน `"Your Document Directory\\"` ด้วยเส้นทางจริงไปยังไดเรกทอรีของคุณ วิธีนี้ช่วยให้โปรแกรมของคุณสามารถค้นหาไฟล์ที่ต้องการใช้งานได้

## ขั้นตอนที่ 2: โหลดเวิร์กบุ๊ก

ขั้นตอนต่อไปคือโหลดเวิร์กบุ๊กที่คุณต้องการบีบอัด:

```csharp
Workbook workbook = new Workbook(sourceDir + "LargeSampleFile.xlsx");
```

ที่นี่เราสร้างอินสแตนซ์ใหม่ของ `Workbook` คลาสและโหลดไฟล์ Excel ที่มีอยู่ ตรวจสอบให้แน่ใจว่าชื่อไฟล์ตรงกับชื่อในไดเร็กทอรีต้นทางของคุณ

## ขั้นตอนที่ 3: ตั้งค่าตัวเลือกการบันทึก

ตอนนี้กำหนดค่าตัวเลือกการบันทึกสำหรับสมุดงานของคุณ:

```csharp
XlsbSaveOptions options = new XlsbSaveOptions();
```

การ `XlsbSaveOptions` คลาสช่วยให้คุณสามารถระบุตัวเลือกต่างๆ ได้เมื่อบันทึกเวิร์กบุ๊กของคุณในรูปแบบ XLSB รวมถึงระดับการบีบอัด

## ขั้นตอนที่ 4: วัดเวลาการบีบอัดสำหรับระดับ 1

เริ่มต้นด้วยระดับการบีบอัดแรกและวัดเวลาที่ใช้ในการบันทึกเวิร์กบุ๊ก:

```csharp
options.CompressionType = OoxmlCompressionType.Level1;
var watch = Stopwatch.StartNew();
workbook.Save(outDir + "LargeSampleFile_level_1_out.xlsb", options);
watch.Stop();
Console.WriteLine("Level 1 Elapsed Time: " + watch.ElapsedMilliseconds + " ms");
```

สไนปเป็ตนี้จะตั้งค่าประเภทการบีบอัดเป็นระดับ 1 บันทึกเวิร์กบุ๊ก และวัดเวลาที่ผ่านไป

## ขั้นตอนที่ 5: วัดเวลาการบีบอัดสำหรับระดับ 6

ต่อไปทดสอบประสิทธิภาพด้วยการบีบอัดระดับ 6:

```csharp
options.CompressionType = OoxmlCompressionType.Level6;
watch = Stopwatch.StartNew();
workbook.Save(outDir + "LargeSampleFile_level_6_out.xlsb", options);
watch.Stop();
Console.WriteLine("Level 6 Elapsed Time: " + watch.ElapsedMilliseconds + " ms");
```

ขั้นตอนนี้คล้ายกับขั้นตอนก่อนหน้า แต่มีระดับการบีบอัดที่สูงกว่า

## ขั้นตอนที่ 6: วัดเวลาการบีบอัดสำหรับระดับ 9

สุดท้าย ให้ประเมินประสิทธิภาพด้วยระดับการบีบอัดสูงสุด:

```csharp
options.CompressionType = OoxmlCompressionType.Level9;
watch = Stopwatch.StartNew();
workbook.Save(outDir + "LargeSampleFile_level_9_out.xlsb", options);
watch.Stop();
Console.WriteLine("Level 9 Elapsed Time: " + watch.ElapsedMilliseconds + " ms");
```

ขั้นตอนนี้จะตั้งระดับการบีบอัดเป็นระดับ 9 ซึ่งคุณจะเห็นขนาดไฟล์ลดลงอย่างเห็นได้ชัดที่สุด แม้ว่าอาจใช้เวลาในการประมวลผลนานกว่าก็ตาม

## ขั้นตอนที่ 7: ผลลัพธ์สุดท้าย

หลังจากเสร็จสิ้นการบีบอัดทุกระดับแล้ว ให้ส่งข้อความระบุว่ากระบวนการเสร็จสิ้นสำเร็จ:

```csharp
Console.WriteLine("Compression adjustment completed successfully.");
```

บรรทัดง่ายๆ นี้ยืนยันว่าโปรแกรมของคุณทำงานได้โดยไม่มีปัญหา

## บทสรุป

การปรับระดับการบีบอัดของเวิร์กบุ๊กของคุณด้วย Aspose.Cells สำหรับ .NET เป็นกระบวนการที่ตรงไปตรงมาซึ่งสามารถนำไปสู่การปรับปรุงที่สำคัญทั้งในด้านขนาดและประสิทธิภาพของไฟล์ การทำตามขั้นตอนที่ระบุไว้ในคู่มือนี้จะช่วยให้คุณสามารถนำการบีบอัดไปใช้ในแอปพลิเคชันของคุณได้อย่างมีประสิทธิภาพ ซึ่งจะช่วยเพิ่มประสิทธิภาพในการจัดการไฟล์ Excel ของคุณ

## คำถามที่พบบ่อย

### Aspose.Cells คืออะไร?  
Aspose.Cells เป็นไลบรารีอันทรงพลังสำหรับ .NET ที่ช่วยให้นักพัฒนาสามารถสร้าง จัดการ และแปลงไฟล์ Excel ได้โดยไม่ต้องใช้ Microsoft Excel

### ฉันจะติดตั้ง Aspose.Cells ได้อย่างไร?  
คุณสามารถดาวน์โหลดและติดตั้ง Aspose.Cells ได้จาก [เว็บไซต์ Aspose](https://releases-aspose.com/cells/net/).

### มีระดับการบีบอัดอะไรบ้าง?  
Aspose.Cells รองรับระดับการบีบอัดหลายระดับ ตั้งแต่ระดับ 1 (การบีบอัดต่ำสุด) ถึงระดับ 9 (การบีบอัดสูงสุด)

### ฉันสามารถทดสอบ Aspose.Cells ได้ฟรีหรือไม่?  
ใช่! คุณสามารถทดลองใช้ Aspose.Cells ได้ฟรี [ที่นี่](https://releases-aspose.com/).

### ฉันสามารถค้นหาการสนับสนุนสำหรับ Aspose.Cells ได้ที่ไหน  
หากมีข้อสงสัยหรือต้องการความช่วยเหลือ โปรดไปที่ฟอรัมสนับสนุน Aspose [ที่นี่](https://forum-aspose.com/c/cells/9).