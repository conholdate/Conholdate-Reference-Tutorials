---
"description": "เรียนรู้วิธีรักษาความปลอดภัยข้อมูลสำคัญในเวิร์กชีต Excel ของคุณโดยการป้องกันแถวเฉพาะโดยใช้ Aspose.Cells สำหรับ .NET บทช่วยสอนที่ครอบคลุมนี้ครอบคลุมทุกอย่างตั้งแต่การตั้งค่าสภาพแวดล้อมของคุณ"
"linktitle": "การป้องกันแถวในเวิร์กชีตโดยใช้ Aspose.Cells"
"second_title": "API การประมวลผล Excel ของ Aspose.Cells .NET"
"title": "การป้องกันแถวในเวิร์กชีตโดยใช้ Aspose.Cells"
"url": "/th/cells/net/mastering-worksheet-security/protecting-rows/"
"weight": 18
---

## การแนะนำ

การทำงานกับไฟล์ Excel ด้วยโปรแกรมมักต้องการไม่เพียงแต่การจัดการข้อมูลเท่านั้น แต่ยังรวมถึงการปกป้องข้อมูลด้วย การปกป้องแถวเฉพาะในเวิร์กชีตมีความสำคัญอย่างยิ่งต่อการปกป้องข้อมูลสำคัญหรือป้องกันการแก้ไขโดยไม่ได้ตั้งใจ ในบทช่วยสอนนี้ เราจะศึกษาวิธีการปกป้องแถวในเวิร์กชีต Excel โดยใช้ Aspose.Cells สำหรับ .NET เราจะแนะนำคุณตลอดขั้นตอนที่จำเป็น ตั้งแต่การตั้งค่าสภาพแวดล้อมของคุณไปจนถึงการใช้งานฟีเจอร์การป้องกันแถวอย่างตรงไปตรงมา

## ข้อกำหนดเบื้องต้น
ก่อนที่คุณจะเริ่มต้น ให้แน่ใจว่าคุณมีสิ่งต่อไปนี้:

1. Aspose.Cells สำหรับ .NET: ดาวน์โหลดและติดตั้งจาก [หน้าดาวน์โหลดเซลล์ Aspose](https://releases-aspose.com/cells/net/).
2. Visual Studio หรือ IDE .NET ใดๆ: คุณต้องมีสภาพแวดล้อมการพัฒนา แนะนำให้ใช้ Visual Studio แต่ IDE ใดๆ ที่เข้ากันได้กับ .NET ก็เพียงพอแล้ว
3. ความรู้พื้นฐานเกี่ยวกับ C#: ความคุ้นเคยกับการเขียนโปรแกรม C# จะช่วยให้คุณทำตามและปรับเปลี่ยนโค้ดตัวอย่างตามที่จำเป็น
4. เอกสาร API ของ Aspose.Cells: ตรวจสอบ [เอกสาร Aspose.Cells สำหรับ .NET](https://reference.aspose.com/cells/net/) เพื่อดูภาพรวมของโครงสร้างและวิธีการของคลาส

เมื่อคุณมีข้อกำหนดเบื้องต้นพร้อมแล้ว เราก็สามารถดำเนินการใช้งานได้

## นำเข้าแพ็คเกจที่จำเป็น
เริ่มต้นด้วยการนำเข้าแพ็กเกจที่จำเป็นลงในโปรเจ็กต์ C# ของคุณ ไลบรารีเหล่านี้จำเป็นสำหรับการโต้ตอบกับไฟล์ Excel

```csharp
using System.IO;
using Aspose.Cells;
```

## ขั้นตอนที่ 1: สร้างเวิร์กบุ๊กและเวิร์กชีตใหม่
ก่อนที่จะใช้การตั้งค่าการป้องกันใดๆ ให้สร้างเวิร์กบุ๊กใหม่และเลือกเวิร์กชีตที่คุณต้องการใช้งาน

```csharp
// กำหนดเส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "Your Document Directory";
// สร้างไดเร็กทอรีหากไม่มีอยู่
if (!Directory.Exists(dataDir))
    Directory.CreateDirectory(dataDir);

// สร้างสมุดงานใหม่และเลือกแผ่นงานแรก
Workbook wb = new Workbook();
Worksheet sheet = wb.Worksheets[0];
```

## ขั้นตอนที่ 2: กำหนดวัตถุ Style และ StyleFlag
กำหนดรูปแบบและวัตถุแฟล็กรูปแบบ ซึ่งจะช่วยให้คุณปรับเปลี่ยนคุณสมบัติของเซลล์ เช่น การล็อกหรือปลดล็อก

```csharp
// กำหนดรูปแบบและวัตถุธงรูปแบบ
Style style;
StyleFlag flag;
```

## ขั้นตอนที่ 3: ปลดล็อคคอลัมน์ทั้งหมดในเวิร์กชีต
โดยค่าเริ่มต้น เซลล์ทั้งหมดในเวิร์กชีต Excel จะถูกล็อก หากต้องการป้องกันเฉพาะบางแถว ให้ปลดล็อกคอลัมน์ทั้งหมดก่อน

```csharp
// วนผ่านทุกคอลัมน์และปลดล็อค
for (int i = 0; i <= 255; i++)
{
    style = sheet.Cells.Columns[i].Style;
    style.IsLocked = false;
    flag = new StyleFlag { Locked = true };
    sheet.Cells.Columns[i].ApplyStyle(style, flag);
}
```

## ขั้นตอนที่ 4: ล็อคแถวเฉพาะ
ตอนนี้ ให้ล็อกแถวที่คุณต้องการปกป้อง ในตัวอย่างนี้ เราจะล็อกแถวแรก

```csharp
// ล็อคแถวแรก
style = sheet.Cells.Rows[0].Style;
style.IsLocked = true;
flag = new StyleFlag { Locked = true };
sheet.Cells.ApplyRowStyle(0, style, flag);
```

คุณสามารถทำซ้ำขั้นตอนนี้สำหรับแถวเพิ่มเติมใดๆ ที่คุณต้องการล็อค

## ขั้นตอนที่ 5: ปกป้องแผ่นงาน
เมื่อล็อกแถวที่จำเป็นแล้ว ก็ถึงเวลาป้องกันเวิร์กชีต การทำเช่นนี้จะป้องกันการแก้ไขแถวที่ถูกล็อก เว้นแต่จะยกเลิกการป้องกัน

```csharp
// ป้องกันแผ่นงาน
sheet.Protect(ProtectionType.All);
```

## ขั้นตอนที่ 6: บันทึกสมุดงาน
สุดท้าย ให้บันทึกเวิร์กบุ๊กพร้อมการเปลี่ยนแปลงที่นำไปใช้ คุณสามารถเลือกรูปแบบต่างๆ ได้ เช่น Excel 97-2003 หรือเวอร์ชันที่ใหม่กว่า

```csharp
// บันทึกไฟล์ Excel
wb.Save(dataDir + "output.out.xls", SaveFormat.Excel97To2003);
```

## บทสรุป
ขอแสดงความยินดี! คุณได้เรียนรู้วิธีการป้องกันแถวในเวิร์กชีต Excel โดยใช้ Aspose.Cells สำหรับ .NET สำเร็จแล้ว ทำตามขั้นตอนเหล่านี้เพื่อปลดล็อกหรือล็อกแถวหรือคอลัมน์ตามต้องการ และใช้การป้องกันเพื่อรักษาความสมบูรณ์ของข้อมูล

## คำถามที่พบบ่อย
### ฉันจะปกป้องหลายแถวพร้อมกันได้อย่างไร
คุณสามารถวนซ้ำผ่านดัชนีแถวหลายรายการและปรับใช้รูปแบบการล็อกกับแต่ละรายการได้

### ฉันสามารถตั้งรหัสผ่านสำหรับการป้องกันแผ่นงานได้หรือไม่
ใช่ คุณสามารถส่งรหัสผ่านไปที่ `sheet.Protect()` วิธีการบังคับใช้การป้องกันด้วยรหัสผ่าน

### ฉันสามารถปลดล็อคเซลล์เฉพาะแทนคอลัมน์ทั้งหมดได้หรือไม่
ใช่ คุณสามารถปลดล็อคเซลล์แต่ละเซลล์ได้โดยการแก้ไขคุณสมบัติรูปแบบแทนที่จะปลดล็อคทั้งคอลัมน์

### จะเกิดอะไรขึ้นหากฉันพยายามแก้ไขแถวที่ได้รับการป้องกัน?
เมื่อแถวได้รับการป้องกัน Excel จะป้องกันการแก้ไขใดๆ ในเซลล์ที่ถูกล็อค เว้นแต่แผ่นงานนั้นจะไม่ได้รับการป้องกัน

### ฉันสามารถปกป้องช่วงเฉพาะภายในแถวหนึ่งได้หรือไม่
ใช่! คุณสามารถล็อคช่วงแต่ละช่วงในแถวได้โดยการตั้งค่า `IsLocked` คุณสมบัติสำหรับเซลล์เฉพาะภายในช่วงนั้น