---
"description": "Узнайте, как легко добавлять цифровую подпись в документы Word с помощью Aspose.Words для .NET. Это подробное руководство охватывает все этапы&#58; от настройки среды и добавления строки подписи до сохранения и проверки подписанных документов."
"linktitle": "Создайте и подпишите новую строку подписи"
"second_title": "API обработки документов Aspose.Words"
"title": "Создайте и подпишите новую строку подписи"
"url": "/ru/words/net/digital-signatures/create-and-sign-new-signature-line/"
"weight": 10
---

## Введение

Хотите добавить цифровую подпись в документ Word? С Aspose.Words для .NET это проще, чем вы думаете! Это руководство поможет вам настроить среду, добавить строку подписи и подписать документ цифровым способом. Приступим!

## Предпосылки

Прежде чем приступать к изучению кода, убедитесь, что у вас есть следующее:

1. Aspose.Words для .NET - [Скачать здесь](https://releases.aspose.com/words/net/).
2. Для этой задачи идеально подходит среда разработки .NET - Visual Studio.
3. Документ для подписания. Вы можете создать новый документ Word или использовать существующий.
4. Файл сертификата - А `.pfx` файл необходим для цифровых подписей.
5. Изображение строки подписи (необязательно) — вы можете прикрепить файл изображения для подписи.

## Импорт требуемых пространств имен

Чтобы использовать функциональные возможности Aspose.Words, вам необходимо импортировать следующие пространства имен:

```csharp
using System;
using System.IO;
using Aspose.Words;
using Aspose.Words.Drawing;
using Aspose.Words.Saving;
using Aspose.Words.Signing;
```

## Шаг 1: Настройка каталога документов

Начните с определения пути к каталогу документов. Именно здесь вы будете сохранять и извлекать свои документы.

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY"; // Укажите путь к каталогу ваших документов
```

## Шаг 2: Создание нового документа

Теперь создадим новый документ Word. Он послужит основой для вашей подписи.

```csharp
Document doc = new Document();
DocumentBuilder builder = new DocumentBuilder(doc);
```

## Шаг 3: Вставка строки подписи

Теперь используйте `DocumentBuilder` класс для вставки строки подписи в ваш документ:

```csharp
SignatureLine signatureLine = builder.InsertSignatureLine(new SignatureLineOptions()).SignatureLine;
```

## Шаг 4: Сохранение документа

После добавления строки подписи сохраните документ. Это важный шаг перед подписанием.

```csharp
doc.Save(dataDir + "SignDocuments.SignatureLine.docx");
```

## Шаг 5: Настройка параметров подписи

Настройте параметры процесса подписания. В том числе укажите идентификатор строки подписи и (необязательно) изображение для отображения вместе с подписью.

```csharp
SignOptions signOptions = new SignOptions
{
    SignatureLineId = signatureLine.Id,
    SignatureLineImage = File.ReadAllBytes(dataDir + "Enhanced Windows MetaFile.emf") // Путь к вашему изображению
};
```

## Шаг 6: Загрузка сертификата

Загрузите файл сертификата, необходимый для подписания документа:

```csharp
CertificateHolder certHolder = CertificateHolder.Create(dataDir + "your_certificate.pfx", "your_password"); // Измените имя файла и пароль.
```

## Шаг 7: Подписание документа

Наконец, подпишите документ, используя `DigitalSignatureUtil` класс. Сохраните подписанный документ под новым именем для дальнейшего использования.

```csharp
DigitalSignatureUtil.Sign(dataDir + "SignDocuments.SignatureLine.docx",
    dataDir + "SignDocuments.SignedDocument.docx", certHolder, signOptions);
```

## Заключение

Поздравляем! Вы успешно создали документ Word, добавили строку подписи и поставили на него цифровую подпись с помощью Aspose.Words for .NET. Этот мощный инструмент упрощает автоматизацию документооборота, гарантируя надёжное подписание и аутентификацию ваших контрактов и официальных документов.

## Часто задаваемые вопросы

### Могу ли я использовать другие форматы изображений для строки подписи?

Да, вы можете использовать различные форматы изображений, включая PNG, JPG и BMP.

### Необходимо ли использовать `.pfx` подать заявку на сертификат?

Да, а `.pfx` Файл — это стандартный формат для хранения сертификатов и закрытых ключей цифровых подписей.

### Можно ли добавить несколько строк подписи в один документ?

Конечно! Вы можете добавить несколько строк подписи, повторяя процесс по мере необходимости.

### Что делать, если у меня нет цифрового сертификата?

Вам необходимо получить цифровой сертификат от доверенного центра сертификации или сгенерировать его с помощью таких инструментов, как OpenSSL.

### Как проверить цифровую подпись в документе?

Вы можете проверить цифровую подпись, открыв подписанный документ в Word и проверив данные подписи, чтобы подтвердить ее подлинность и целостность.