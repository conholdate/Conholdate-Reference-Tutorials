---
"description": "Узнайте, как эффективно управлять большими файлами Excel, настраивая уровни сжатия с помощью Aspose.Cells для .NET. Это пошаговое руководство охватывает все этапы — от настройки каталогов до измерения времени сжатия, — помогая оптимизировать размер файла и повысить производительность."
"linktitle": "Настройка уровня сжатия в рабочей книге"
"second_title": "API обработки Excel Aspose.Cells .NET"
"title": "Настройка уровня сжатия в рабочей книге"
"url": "/ru/cells/net/mastering-workbook-operations/adjusting-compression-level/"
"weight": 14
---

## Введение

Управление большими файлами Excel может быть непростой задачей, особенно когда речь идёт об эффективности хранения и передачи данных. К счастью, сжатие файлов может значительно уменьшить их размер, упрощая работу с ними. Если вы используете Aspose.Cells для .NET, вы можете легко настроить уровень сжатия своих рабочих книг. Это руководство пошагово проведёт вас через весь процесс, предоставляя понятные объяснения каждой части кода.

## Предпосылки

Прежде чем углубляться в код, убедитесь, что у вас выполнены следующие предварительные условия:

1. Базовые знания C#: знакомство с программированием на C# поможет вам лучше понимать фрагменты кода.
2. Библиотека Aspose.Cells: Загрузите и установите библиотеку Aspose.Cells с сайта [здесь](https://releases.aspose.com/cells/net/).
3. Visual Studio: Для запуска кода необходима среда разработки, такая как Visual Studio.
4. .NET Framework: Убедитесь, что ваш проект настроен на совместимую версию .NET Framework.

## Импорт необходимых пакетов

Для начала вам необходимо импортировать необходимые пакеты в ваш проект C#. Добавьте следующие строки в начало файла кода:

```csharp
using Aspose.Cells.Rendering;
using Aspose.Cells.WebExtensions;
using System;
```

Эти пакеты необходимы для работы с файлами Excel с использованием библиотеки Aspose.Cells. `Aspose.Cells` Пространство имен содержит все классы, необходимые для работы с файлами Excel, при этом `Aspose.Cells.Xlsb` предоставляет возможность сохранения файлов в формате XLSB.

## Шаг 1: Определите исходный и выходной каталоги

Сначала настройте каталоги, в которых находятся исходные файлы и куда вы хотите сохранить выходные файлы:

```csharp
// Определить исходные и выходные каталоги
string sourceDir = "Your Document Directory\\";
string outDir = "Your Document Directory\\";
```

Обязательно замените `"Your Document Directory\\"` с реальными путями к вашим каталогам. Это гарантирует, что ваша программа сможет найти необходимые ей файлы.

## Шаг 2: Загрузите рабочую книгу

Затем загрузите книгу, которую вы хотите сжать:

```csharp
Workbook workbook = new Workbook(sourceDir + "LargeSampleFile.xlsx");
```

Здесь мы создаем новый экземпляр `Workbook` class и загрузите существующий файл Excel. Убедитесь, что имя файла совпадает с именем в исходном каталоге.

## Шаг 3: Настройте параметры сохранения

Теперь настройте параметры сохранения вашей книги:

```csharp
XlsbSaveOptions options = new XlsbSaveOptions();
```

The `XlsbSaveOptions` класс позволяет вам указывать различные параметры при сохранении вашей книги в формате XLSB, включая уровни сжатия.

## Шаг 4: Измерьте время сжатия для уровня 1

Начните с первого уровня сжатия и измерьте время, необходимое для сохранения книги:

```csharp
options.CompressionType = OoxmlCompressionType.Level1;
var watch = Stopwatch.StartNew();
workbook.Save(outDir + "LargeSampleFile_level_1_out.xlsb", options);
watch.Stop();
Console.WriteLine("Level 1 Elapsed Time: " + watch.ElapsedMilliseconds + " ms");
```

Этот фрагмент устанавливает тип сжатия на Уровень 1, сохраняет книгу и измеряет прошедшее время.

## Шаг 5: Измерьте время сжатия для уровня 6

Далее протестируем производительность при сжатии уровня 6:

```csharp
options.CompressionType = OoxmlCompressionType.Level6;
watch = Stopwatch.StartNew();
workbook.Save(outDir + "LargeSampleFile_level_6_out.xlsb", options);
watch.Stop();
Console.WriteLine("Level 6 Elapsed Time: " + watch.ElapsedMilliseconds + " ms");
```

Этот шаг аналогичен предыдущему, но с более высоким уровнем сжатия.

## Шаг 6: Измерьте время сжатия для уровня 9

Наконец, оцените производительность при самом высоком уровне сжатия:

```csharp
options.CompressionType = OoxmlCompressionType.Level9;
watch = Stopwatch.StartNew();
workbook.Save(outDir + "LargeSampleFile_level_9_out.xlsb", options);
watch.Stop();
Console.WriteLine("Level 9 Elapsed Time: " + watch.ElapsedMilliseconds + " ms");
```

На этом этапе устанавливается уровень сжатия 9, при котором вы, скорее всего, увидите наиболее значительное уменьшение размера файла, хотя обработка может занять больше времени.

## Шаг 7: Окончательный результат

После завершения всех уровней сжатия вывести сообщение об успешном завершении процесса:

```csharp
Console.WriteLine("Compression adjustment completed successfully.");
```

Эта простая строка подтверждает, что ваша программа выполнена без проблем.

## Заключение

Настройка уровня сжатия рабочих книг с помощью Aspose.Cells for .NET — простой процесс, который может значительно сократить размер файла и повысить производительность. Следуя инструкциям, описанным в этом руководстве, вы сможете эффективно реализовать сжатие в своих приложениях, расширяя возможности управления файлами Excel.

## Часто задаваемые вопросы

### Что такое Aspose.Cells?  
Aspose.Cells — мощная библиотека для .NET, которая позволяет разработчикам создавать, обрабатывать и преобразовывать файлы Excel без использования Microsoft Excel.

### Как установить Aspose.Cells?  
Вы можете загрузить и установить Aspose.Cells с сайта [Сайт Aspose](https://releases.aspose.com/cells/net/).

### Какие уровни сжатия доступны?  
Aspose.Cells поддерживает несколько уровней сжатия: от уровня 1 (самое низкое сжатие) до уровня 9 (самое высокое сжатие).

### Могу ли я бесплатно протестировать Aspose.Cells?  
Да! Вы можете получить бесплатную пробную версию Aspose.Cells. [здесь](https://releases.aspose.com/).

### Где я могу найти поддержку Aspose.Cells?  
По любым вопросам или для получения поддержки посетите форум поддержки Aspose. [здесь](https://forum.aspose.com/c/cells/9).