---
"description": "Раскройте весь потенциал преобразования Excel в PDF с помощью Aspose.Cells для .NET. В этом подробном руководстве вы узнаете, как управлять внешними ресурсами, такими как изображения, чтобы ваши PDF-файлы точно соответствовали вашим требованиям к форматированию."
"linktitle": "Управление внешними ресурсами с помощью Aspose.Cells для .NET"
"second_title": "API обработки Excel Aspose.Cells .NET"
"title": "Управление внешними ресурсами с помощью Aspose.Cells для .NET"
"url": "/ru/cells/net/mastering-rendering-and-exporting/control-external-resources/"
"weight": 12
---

## Введение

В современном цифровом мире преобразование таблиц Excel в PDF-документы — распространённая и важная задача. Независимо от того, готовите ли вы отчёты, финансовые данные или презентации, крайне важно, чтобы ваши PDF-файлы соответствовали заданному формату. Aspose.Cells для .NET предоставляет мощную библиотеку, позволяющую детально контролировать процесс преобразования, особенно при работе с внешними ресурсами, такими как изображения. В этом руководстве мы рассмотрим, как эффективно управлять внешними ресурсами при преобразовании Excel в PDF с помощью Aspose.Cells. Давайте разберёмся!

## Предпосылки

Прежде чем начать, убедитесь, что у вас готово следующее:

1. Visual Studio или любая совместимая с .NET IDE: это будет ваша среда разработки.
2. Aspose.Cells для .NET: если вы еще не установили его, посетите [Загрузки Aspose](https://releases.aspose.com/cells/net/) страницу, чтобы получить последнюю версию.
3. Базовые знания C#: знакомство с C# будет преимуществом. Если вам нужны разъяснения по каким-либо концепциям, не стесняйтесь обратиться к нам.
4. Пример файла Excel: подготовьте файл Excel, например «samplePdfSaveOptions_StreamProvider.xlsx», содержащий внешние ресурсы, которые вы хотите преобразовать.
5. Файл изображения для тестирования: используйте файл изображения, например «newPdfSaveOptions_StreamProvider.png», в качестве внешнего ресурса во время преобразования.

## Импорт необходимых пакетов

Для начала вам необходимо импортировать необходимые пространства имён из библиотеки Aspose.Cells. Добавьте следующие директивы using в начало вашего C#-файла:

```csharp
using System.IO;
using System.Drawing;
using System.Drawing.Imaging;
using Aspose.Cells;
using Aspose.Cells.Drawing;
using Aspose.Cells.Rendering;
using System;
```

Эти пространства имен предоставляют основные классы и методы для ваших задач.

## Шаг 1: Создание класса поставщика потока

Сначала создайте класс поставщика потока, который реализует `IStreamProvider` Интерфейс. Этот класс позволит вам управлять загрузкой внешних ресурсов.

```csharp
class MyStreamProvider : IStreamProvider
{
    public void CloseStream(StreamProviderOptions options)
    {
        Debug.WriteLine("-----Close Stream-----");
    }

    public void InitStream(StreamProviderOptions options)
    {
        string sourceDir = "Your Document Directory";
        Debug.WriteLine("-----Init Stream-----");
        
        // Загрузить изображение в поток памяти
        byte[] bts = File.ReadAllBytes(Path.Combine(sourceDir, "newPdfSaveOptions_StreamProvider.png"));
        MemoryStream ms = new MemoryStream(bts);
        options.Stream = ms;
    }
}
```

- CloseStream: этот метод вызывается при закрытии потока и в данный момент регистрирует отладочное сообщение.
- InitStream: этот метод считывает внешний файл изображения как массив байтов, преобразует его в поток памяти и присваивает его `options.Stream` свойство.

## Шаг 2: Настройте исходный и выходной каталоги

Затем определите каталоги для вашего файла Excel и выходного PDF-файла.

```csharp
// Исходный каталог
string sourceDir = "Your Document Directory";
// Выходной каталог
string outputDir = "Your Document Directory";
```

Заменять `"Your Document Directory"` с фактическим путем в вашей системе, где расположены ваши файлы.

## Шаг 3: Загрузите файл Excel

Теперь загрузите файл Excel, из которого вы хотите создать PDF-файл.

```csharp
// Загрузите исходный файл Excel, содержащий внешние изображения.
Workbook wb = new Workbook(sourceDir, "samplePdfSaveOptions_StreamProvider.xlsx");
```

The `Workbook` Класс из Aspose.Cells представляет ваш файл Excel, который может включать различные внешние ресурсы, такие как изображения.

## Шаг 4: Задайте параметры сохранения PDF-файла

Перед сохранением книги в формате PDF укажите желаемые параметры сохранения.

```csharp
// Укажите параметры сохранения PDF-файла — поставщик потоковой передачи
PdfSaveOptions opts = new PdfSaveOptions
{
    OnePagePerSheet = true // Сохраняйте каждый лист на новой странице.
};
```

Это создает экземпляр `PdfSaveOptions`, что позволяет вам настроить формат PDF. `OnePagePerSheet` эта опция гарантирует, что каждый лист Excel будет отображаться на отдельной странице в итоговом PDF-файле.

## Шаг 5: Назначьте поставщика потоковой передачи

Подключите свой `Workbook` экземпляр с `MyStreamProvider` класс, который вы создали ранее.

```csharp
wb.Settings.StreamProvider = new MyStreamProvider();
```

Эта строка гарантирует, что при обнаружении внешних ресурсов во время преобразования ваш поставщик будет управлять ими соответствующим образом.

## Шаг 6: Сохраните рабочую книгу в формате PDF

Теперь сохраните вашу книгу Excel как PDF-файл.

```csharp
// Сохранить рабочую книгу в формате PDF
wb.Save(outputDir + "outputPdfSaveOptions_StreamProvider.pdf", opts);
```

Позвонив по номеру `Save` Применив метод к объекту рабочей книги и передав выходной каталог вместе с параметрами PDF, вы преобразуете файл Excel в хорошо отформатированный PDF-файл.

## Шаг 7: Подтвердите успешное выполнение

Наконец, хорошей практикой будет подтверждение того, что процесс завершился успешно.

```csharp
Console.WriteLine("ControlLoadingOfExternalResourcesInExcelToPDF executed successfully.\r\n");
```

Это сообщение проинформирует вас о статусе вашей операции, предоставляя полезную обратную связь.

## Заключение

Вы освоили процесс управления внешними ресурсами при конвертации Excel в PDF с помощью Aspose.Cells! Выполнив эти шаги, вы сможете гарантировать, что ваши документы будут содержать изображения и другие внешние элементы без ошибок, что позволит вам получать безупречный конечный продукт.

## Часто задаваемые вопросы

### Что такое Aspose.Cells?
Aspose.Cells — мощная библиотека для разработчиков .NET, которая позволяет создавать, обрабатывать, преобразовывать и отображать файлы Excel в различных форматах.

### Как загрузить Aspose.Cells?
Вы можете загрузить последнюю версию с сайта [Ссылка для скачивания](https://releases.aspose.com/cells/net/).

### Могу ли я попробовать Aspose.Cells бесплатно?
Да! Вы можете получить бесплатную пробную версию, посетив [Бесплатная пробная версия страницы](https://releases.aspose.com/).

### Где я могу найти поддержку Aspose.Cells?
По вопросам поддержки посетите [Форум поддержки Aspose](https://forum.aspose.com/c/cells/9).

### Как получить временную лицензию для Aspose.Cells?
Вы можете подать заявление на получение временной лицензии [здесь](https://purchase.aspose.com/temporary-license/).