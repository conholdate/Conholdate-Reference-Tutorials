---
"description": "Узнайте, как изменить шрифты при конвертации MHT с помощью Aspose.Email для .NET. Следуйте этому пошаговому руководству для простой настройки."
"linktitle": "Изменение настройки шрифта MHT с помощью C#"
"second_title": "API обработки электронной почты Aspose.Email .NET"
"title": "Изменение настройки шрифта MHT с помощью C#"
"url": "/ru/email/net/mastering-email-header-manipulation/changing-mht-font-customization/"
"weight": 11
---

## Введение

В мире веб-коммуникаций файлы MHT (MHTML) — это удобный способ хранения и распространения веб-контента, включая изображения, ссылки и стили. Но что делать, если вам нужно изменить шрифты в этих файлах MHT? Благодаря Aspose.Email for .NET эта задача становится проще простого. В этом руководстве мы шаг за шагом рассмотрим процесс изменения шрифтов при конвертации в MHT. Разрабатываете ли вы приложение для форматирования электронных писем или просто хотите настроить документы для своего бизнеса, это руководство предоставит вам необходимые знания.

## Предпосылки

Прежде чем погрузиться в код, вам следует подготовить несколько основных вещей:

1. Visual Studio: для работы над проектом C# вам понадобится интегрированная среда разработки (IDE).
2. Библиотека Aspose.Email для .NET: Убедитесь, что у вас установлена библиотека. Вы можете скачать её с сайта [связь](https://releases.aspose.com/email/net/).
3. .NET Framework: Ваш проект должен быть совместим с .NET Framework; обычно хорошо работают .NET Core или более поздние версии.

Всё готово? Отлично! Давайте начнём.

## Импорт пакетов

Прежде всего, убедитесь, что ваш проект настроен на использование необходимых пространств имён. В начало файла C# необходимо добавить следующее:

```csharp
using Aspose.Email;
using Aspose.Email.Mime;
using Aspose.Email.Tools;
```

Эти пакеты предоставят вам доступ к функциям, необходимым для работы с файлами MHT и изменения их содержимого.

Теперь давайте рассмотрим шаги по изменению шрифтов во время конвертации MHT.

## Шаг 1: Загрузите MHT-файл

Первое, что вам нужно сделать, это загрузить ваш MHT-файл в `MailMessage` Объект. Здесь вы можете получить доступ к его содержимому и управлять им.

```csharp
MailMessage message = MailMessage.Load("input.mht", new MhtmlLoadOptions());
```

Пояснение: Здесь, `"input.mht"` это путь к вашему MHT-файлу. `MhtmlLoadOptions()` позволяет настроить способ загрузки файла, например, по-разному обрабатывать вложения или связанные ресурсы.

## Шаг 2: Перебор альтернативных представлений

Файлы MHT часто имеют несколько альтернативных представлений, особенно если они содержат HTML-контент. Вам необходимо просмотреть все эти представления, чтобы найти то, которое нужно изменить.

```csharp
foreach (var alternateView in message.AlternateViews)
{
    if (alternateView.ContentType.MediaType == "text/html")
    {
        var htmlView = (AlternateView)alternateView;
        var linkedResources = htmlView.LinkedResources;
```

Объяснение: Вы проверяете каждый `AlternateView` чтобы проверить, относится ли он к типу HTML. Если это так, вы можете получить доступ `LinkedResources`, где обычно хранятся все шрифты, связанные в HTML.

## Шаг 3: Определите и настройте шрифты

Теперь, когда у вас есть доступ к связанным ресурсам, вы можете определить, какие ресурсы являются шрифтами, и настроить их по мере необходимости.

```csharp
foreach (var linkedResource in linkedResources)
{
    if (linkedResource.ContentType.MediaType == "application/x-font-ttf")
    {
        linkedResource.ContentType.Name = "Arial";  // Изменить на желаемый шрифт
        linkedResource.TransferEncoding = TransferEncoding.Base64;  // Убедитесь, что он правильно закодирован.
    }
}
```

Пояснение: Этот цикл проверяет, является ли тип содержимого связанного ресурса шрифтом TrueType. Если он соответствует, вы можете изменить название шрифта на желаемое (например, «Arial» в данном примере). `TransferEncoding` также следует настроить так, чтобы гарантировать правильную кодировку данных шрифта при сохранении документа.

## Шаг 4: Сохраните обновленный файл MHT.

После настройки шрифтов необходимо сохранить изменённый MHT-файл. Убедитесь, что вы используете правильные параметры сохранения, чтобы сохранить целостность файла.

```csharp
message.Save("output.mht", SaveOptions.DefaultMhtml);
```

Пояснение: В этой строке кода `"output.mht"` — это имя файла, в котором вы хотите сохранить обновлённый контент. Использование `SaveOptions.DefaultMhtml` гарантирует, что новый файл сохранит формат MHT.

## Заключение

Изменение шрифтов в MHT-файлах может значительно улучшить внешний вид ваших документов. Используя Aspose.Email for .NET, вы можете легко загружать MHT-файлы, изменять их содержимое и сохранять изменения, используя всего несколько строк кода. Независимо от того, работаете ли вы над личным проектом или над более крупным приложением, освоение этих навыков может улучшить представление информации.

## Часто задаваемые вопросы

### Что такое формат MHT?
MHT — это формат архива веб-страниц, в котором HTML-документы, изображения и другие ресурсы хранятся в одном файле.

### Могу ли я изменить другие аспекты MHT-файлов с помощью Aspose?
Конечно! Aspose.Email позволяет изменять практически любой аспект MHT-файлов, включая вложения, заголовки и многое другое.

### Является ли Aspose.Email для .NET бесплатным?
Aspose предлагает бесплатную пробную версию, но для полной версии требуется лицензия. Вы можете получить временную лицензию. [здесь](https://purchase.aspose.com/temporary-license/).

### Где я могу найти дополнительную документацию по Aspose.Email?
Подробную документацию и примеры можно найти на сайте [Страница документации Aspose Email](https://reference.aspose.com/email/net/).

### Что делать, если у меня возникнут проблемы при использовании Aspose?
Если у вас возникнут какие-либо проблемы, вы можете обратиться за поддержкой по адресу [Форум поддержки Aspose](https://forum.aspose.com/c/email/12/).