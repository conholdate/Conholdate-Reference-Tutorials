---
"description": "В этом пошаговом руководстве вы узнаете, как определить пользовательский порядок информации в MHTML с помощью Aspose.Email для .NET."
"linktitle": "Индивидуальный порядок информации в MHTML с помощью Aspose.Email"
"second_title": "API обработки электронной почты Aspose.Email .NET"
"title": "Индивидуальный порядок информации в MHTML с помощью Aspose.Email"
"url": "/ru/email/net/mastering-email-header-manipulation/custom-order-of-information-in-mhtml/"
"weight": 14
---

## Введение

Создание расширенных форматов электронных писем может значительно улучшить коммуникацию, особенно при экспорте писем в различные форматы файлов, такие как MHTML. Aspose.Email для .NET предоставляет разработчикам мощный инструментарий для работы с электронными письмами, включая настройку порядка отображения информации при экспорте в MHTML. В этом руководстве мы подробно рассмотрим необходимые для этого шаги, что упрощает понимание, независимо от того, являетесь ли вы опытным разработчиком или новичком. Итак, приступим!

## Предпосылки

Прежде чем приступить к определению индивидуального порядка информации в MHTML, необходимо проверить несколько предварительных условий в своем списке:

1. Среда разработки .NET: Убедитесь, что у вас настроена среда разработки .NET. Вы можете использовать Visual Studio, Visual Studio Code или любую другую совместимую IDE.

2. Библиотека Aspose.Email: Вам необходимо установить библиотеку Aspose.Email for .NET. Вы можете загрузить последнюю версию с сайта [Страница релизов Aspose](https://releases.aspose.com/email/net/).

3. Базовое понимание C#: знакомство с программированием на C# поможет вам лучше понимать код.

4. Образец файла электронного письма: Вам понадобится образец `.eml` файл (например, `Attachments.eml`) для целей тестирования.

Если у вас есть все эти предварительные условия, вы готовы приступить к изучению руководства!

## Импортные пакеты

Чтобы начать работу с кодом, вам потребуется импортировать необходимые пространства имён из библиотеки Aspose.Email. Это необходимо для доступа ко всем классам и методам, необходимым для работы с файлами электронной почты.

```csharp
using Aspose.Email;
using Aspose.Email.Mime;
using Aspose.Email.Mhtml;
```

Добавьте их в начало файла C#. Теперь вы готовы погрузиться в кодинг!

Теперь, когда у вас все готово, давайте разобьем руководство на выполнимые шаги.

## Шаг 1: Настройте каталог данных

Первое, что нужно сделать, — это создать каталог, в котором будут храниться файлы электронной почты. Это может быть любой путь на вашем локальном компьютере.

```csharp
string dataDir = "Your Data Directory";
```

Заменять `"Your Data Directory"` с фактическим путем, где ваш `.eml` Файл находится. Например, если ваш файл находится в `C:\Emails`, вы бы написали:

```csharp
string dataDir = @"C:\Emails\";
```

## Шаг 2: загрузка сообщения электронной почты

Далее вам необходимо загрузить `.eml` файл в `MailMessage` Объект. Это позволяет вам управлять содержимым и метаданными письма.

```csharp
MailMessage eml = MailMessage.Load(dataDir + "Attachments.eml");
```

Убедитесь, что имя файла совпадает с именем в указанном каталоге. Если имя файла отличается, измените его соответствующим образом.

## Шаг 3: Настройте параметры сохранения MHTML

После загрузки письма нужно определить, как вы хотите сохранить его в формате MHTML. Можно начать с параметров по умолчанию.

```csharp
MhtSaveOptions opt = SaveOptions.DefaultMhtml;
```

Эта строка инициализирует параметры сохранения MHTML, подготавливая почву для последующей настройки заголовков.

## Шаг 4: Сохраните MHTML с порядком по умолчанию

Давайте сохраним письмо в формате MHTML, используя порядок по умолчанию. Это даст вам базовый уровень для сравнения после настройки.

```csharp
eml.Save(dataDir + "CustomOrderOfInformationInMHTML_1.mhtml", opt);
```

Запустите эту строку и проверьте указанный каталог. Вы должны увидеть новый MHTML-файл с именем `CustomOrderOfInformationInMHTML_1.mhtml`. Откройте его, чтобы увидеть, как информация отображается по умолчанию.

## Шаг 5: Настройте порядок заголовков

А теперь самое интересное! Вы можете указать, какие заголовки и в каком порядке включать в MHTML-вывод. Начнём с некоторых распространённых заголовков.

```csharp
opt.RenderingHeaders.Add(MhtTemplateName.From);
opt.RenderingHeaders.Add(MhtTemplateName.Subject);
opt.RenderingHeaders.Add(MhtTemplateName.To);
opt.RenderingHeaders.Add(MhtTemplateName.Sent);
```

Добавляя эти заголовки, вы сообщаете Aspose, как вы хотите, чтобы отображалось электронное письмо.

## Шаг 6: Сохраните MHTML с пользовательским порядком

После настройки заголовков необходимо снова сохранить электронное письмо в формате MHTML, чтобы увидеть, как новый порядок повлияет на вывод.

```csharp
eml.Save(dataDir + "CustomOrderOfInformationInMHTML_2.mhtml", opt);
```

Запустите этот код, затем откройте `CustomOrderOfInformationInMHTML_2.mhtml`Сравните его с первым, чтобы увидеть, как изменилась информация в зависимости от порядка заголовков.

## Шаг 7: Очистка и добавление нового порядка заголовков

Что делать, если вам нужен совершенно другой порядок? Вы можете начать всё заново, очистив текущие настройки заголовка.

```csharp
opt.RenderingHeaders.Clear();
```

Теперь пора определить новый порядок заголовков. Например, если вы хотите установить приоритет вложений и копировать получателей:

```csharp
opt.RenderingHeaders.Add(MhtTemplateName.Attachments);
opt.RenderingHeaders.Add(MhtTemplateName.Cc);
opt.RenderingHeaders.Add(MhtTemplateName.Subject);
```

## Шаг 8: Сохраните MHTML с новым пользовательским заказом

Наконец, сохраните электронное письмо еще раз с новыми настройками заголовка.

```csharp
eml.Save(dataDir + "CustomOrderOfInformationInMHTML_3.mhtml", opt);
```

После запуска этой строки откройте `CustomOrderOfInformationInMHTML_3.mhtml` и проверьте, как он представляет информацию с учетом ваших новых настроек.

## Заключение

Вот и всё — простое руководство по заданию произвольного порядка информации в MHTML с помощью Aspose.Email для .NET. Выполнив эти шаги, вы сможете управлять представлением своих писем в формате MHTML, гарантируя, что самая важная информация будет представлена в соответствии с вашими потребностями. 

## Часто задаваемые вопросы

### Что такое MHTML?
MHTML означает «MIME HTML», формат архива веб-страниц, который объединяет HTML и другие ресурсы, такие как изображения.

### Могу ли я использовать Aspose.Email бесплатно?
Да, Aspose предоставляет разработчикам бесплатную пробную версию. Вы можете найти её здесь. [здесь](https://releases.aspose.com/).

### Что делать, если у меня возникнут проблемы при использовании Aspose.Email?
Вы можете получить поддержку от сообщества через [Форум Aspose](https://forum.aspose.com/c/email/12/).

### Доступна ли временная лицензия для Aspose.Email?
Да, вы можете подать заявление на получение временной лицензии. [здесь](https://purchase.aspose.com/temporary-license/).

### Где я могу купить Aspose.Email?
Вы можете приобрести библиотеку здесь [связь](https://purchase.aspose.com/buy).